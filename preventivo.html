<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<title>Preventivo Stampa 3D - Solo STL</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  #viewer {
    width: 500px; height: 500px;
    background: #eee;
    border: 2px dashed #ccc;
    display: flex; align-items: center; justify-content: center;
    color: #666;
    user-select: none;
    margin-bottom: 20px;
    position: relative;
  }
  #viewer.dragover { border-color: #333; background: #ddd; color: #000; }
  #controls { max-width: 400px; margin-bottom: 20px; }
  label { font-weight: bold; margin-top: 10px; display: block; }
  input, select, button { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; }
  #info { margin-top: 15px; background: #fafafa; padding: 10px; border: 1px solid #ddd; min-height: 60px; }
  #result { margin-top: 10px; padding: 10px; background: #e0ffe0; display: none; font-weight: bold; }
  #material-alert {
    display: none;
    margin-top: 10px;
    padding: 10px;
    background: #ffe0e0;
    color: #900;
    font-weight: bold;
    border: 1px solid #d00;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 30px;
  }
  th, td {
    border: 1px solid #ccc;
    padding: 8px;
    text-align: left;
  }
  th {
    background-color: #f4f4f4;
  }
  .clickable {
    cursor: pointer;
    text-align: center;
  }
</style>
</head>
<body>

<div id="controls">
  <button id="btn-upload">Carica file STL</button>
  <input type="file" id="file-input" accept=".stl" style="display:none" />

  <label>Materiale</label>
  <select id="sel-material">
    <option value="PLA" data-price="0.02">PLA (€0.02/g)</option>
    <option value="ABS" data-price="0.025">ABS (€0.025/g)</option>
    <option value="PETG" data-price="0.03">PETG (€0.03/g)</option>
    <option value="Nylon" data-price="0.05">Nylon (€0.05/g)</option>
    <option value="TPU" data-price="0.045">TPU (€0.045/g)</option>
    <option value="PETG CF" data-price="0.06">PETG CF (€0.06/g)</option>
    <option value="PLA+" data-price="0.025">PLA+ (€0.025/g)</option>
  </select>

  <label>Ugello (mm)</label>
  <select id="sel-nozzle">
    <option value="0.4">0.4</option>
    <option value="0.6">0.6</option>
    <option value="0.8">0.8</option>
  </select>

  <label>Velocità (mm/s)</label>
  <input type="number" id="inp-speed" min="10" max="200" value="50" />

  <label>Riempimento (%)</label>
  <input type="number" id="inp-infill" min="0" max="100" value="20" />

  <button id="btn-calc" style="margin-top:15px;">Calcola Preventivo</button>
</div>

<div id="viewer">Trascina qui il file STL o usa il bottone sopra.</div>
<div id="info"><strong>Dimensioni modello:</strong><br>Larghezza: –<br>Altezza: –<br>Profondità: –</div>
<div id="result"></div>
<div id="material-alert">Materiale non disponibile (ordine minimo 500g)</div>

<h2>Materiali supportati</h2>
<table>
  <thead>
    <tr>
      <th>Nome</th>
      <th>Nome Chimico</th>
      <th>Proprietà</th>
      <th>Applicazioni</th>
      <th>Disponibile</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>PLA Basic</td><td>Acido Polilattico</td><td>Facile da stampare, biodegradabile</td><td>Oggetti estetici, prototipi</td><td class="clickable">✅</td></tr>
    <tr><td>PLA+</td><td>PLA modificato</td><td>Più resistente e flessibile</td><td>Prototipi funzionali</td><td class="clickable">❌</td></tr>
    <tr><td>ABS</td><td>Acrilonitrile Butadiene Stirene</td><td>Resistente al calore</td><td>Parti meccaniche</td><td class="clickable">❌</td></tr>
    <tr><td>PETG</td><td>Polietilene Tereftalato Glicole</td><td>Robusto, trasparente</td><td>Contenitori, parti funzionali</td><td class="clickable">❌</td></tr>
    <tr><td>PETG CF</td><td>PETG + Fibra di carbonio</td><td>Rigido, resistente</td><td>Componenti tecnici</td><td class="clickable">✅</td></tr>
    <tr><td>Nylon</td><td>Poliammide</td><td>Flessibile, molto resistente</td><td>Ingranaggi, parti tecniche</td><td class="clickable">❌</td></tr>
    <tr><td>TPU 95A</td><td>Poliuretano termoplastico</td><td>Flessibile, gommoso</td><td>Cover, ammortizzatori</td><td class="clickable">✅</td></tr>
  </tbody>
</table>

<script>
  const alertBox = document.getElementById("material-alert");
  document.querySelectorAll("td.clickable").forEach(td => {
    td.addEventListener("click", () => {
      if (td.textContent.trim() === "❌") {
        const pesoText = document.getElementById("result").innerText.match(/Peso stimato: ([\d\.]+) g/);
        const peso = pesoText ? parseFloat(pesoText[1]) : 0;
        if (peso < 500) {
          alertBox.style.display = "block";
          setTimeout(() => alertBox.style.display = "none", 2000);
        }
      }
    });
  });
</script>

</body>
</html>
